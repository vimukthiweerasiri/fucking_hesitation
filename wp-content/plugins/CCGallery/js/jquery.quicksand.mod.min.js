/*

Quicksand 1.2.2

Reorder and filter items with a nice shuffling animation.

Copyright (c) 2010 Jacek Galanciak (razorjack.net) and agilope.com
Big thanks for Piotr Petrus (riddle.pl) for deep code review and wonderful docs & demos.

Dual licensed under the MIT and GPL version 2 licenses.
http://github.com/jquery/jquery/blob/master/MIT-LICENSE.txt
http://github.com/jquery/jquery/blob/master/GPL-LICENSE.txt

Project site: http://razorjack.net/quicksand
Github site: http://github.com/razorjack/quicksand

*/


(function(a){a.fn.quicksand=function(h,b){var f={duration:750,easing:"swing",attribute:"data-id",adjustHeight:"auto",useScaling:true,enhancement:function(i){},selector:"> *",dx:0,dy:0};a.extend(f,b);var e=navigator.appName.toLowerCase().indexOf("microsoft")!=-1,g=parseFloat(navigator.appVersion.split("MSIE")[1],10);if(e||(typeof(a.fn.scale)=="undefined")){f.useScaling=false}var c;if(typeof(arguments[1])=="function"){var c=arguments[1]}else{if(typeof(arguments[2]=="function")){var c=arguments[2]}}return this.each(function(x){var C;var A=[];var l=a(h).clone();var B=a(this);var k=a(this).css("height");var q;var m=false;var n=a(B).offset();var o=[];var z=a(this).find(f.selector);var w=z.css("width");if(e&&g<7){B.html("").append(l);return}var p=0;var t=function(){if(!p){p=1;$toDelete=B.find("> *");B.prepend(u.find("> *"));$toDelete.remove();if(m){B.css("height",q)}f.enhancement(B);if(typeof c=="function"){c.call(this)}}};var y=B.offsetParent();var v=y.offset();if(y.css("position")=="relative"){if(y.get(0).nodeName.toLowerCase()=="body"){}else{v.top+=(parseFloat(y.css("border-top-width"))||0);v.left+=(parseFloat(y.css("border-left-width"))||0)}}else{v.top-=(parseFloat(y.css("border-top-width"))||0);v.left-=(parseFloat(y.css("border-left-width"))||0);v.top-=(parseFloat(y.css("margin-top"))||0);v.left-=(parseFloat(y.css("margin-left"))||0)}if(isNaN(v.left)){v.left=0}if(isNaN(v.top)){v.top=0}v.left-=f.dx;v.top-=f.dy;B.css("height",a(this).css("height"));z.each(function(D){o[D]=a(this).offset()});a(this).stop();var s=0;var r=0;z.each(function(D){a(this).stop();var E=a(this).get(0);if(E.style.position=="absolute"){s=-f.dx;r=-f.dy}else{s=f.dx;r=f.dy}E.style.position="absolute";E.style.margin="0";E.style.width=w;E.style.top=(o[D].top-parseFloat(E.style.marginTop)-v.top+r)+"px";E.style.left=(o[D].left-parseFloat(E.style.marginLeft)-v.left+s)+"px"});var u=a(B).clone();var j=u.get(0);j.innerHTML="";j.setAttribute("id","");j.style.height="auto";j.style.width=B.css("width");u.append(l);u.insertBefore(B);u.css("opacity",0);j.style.zIndex=-1;j.style.margin="0";j.style.position="absolute";j.style.top=n.top-v.top+"px";j.style.left=n.left-v.left+"px";if(f.adjustHeight==="dynamic"){B.animate({height:u.height()},f.duration,f.easing)}else{if(f.adjustHeight==="auto"){q=u.height();if(parseFloat(k)<parseFloat(q)){B.css("height",q)}else{m=true}}}z.each(function(D){var E=[];if(typeof(f.attribute)=="function"){C=f.attribute(a(this));l.each(function(){if(f.attribute(this)==C){E=a(this);return false}})}else{E=l.filter("["+f.attribute+"="+a(this).attr(f.attribute)+"]")}if(E.length){if(!f.useScaling){A.push({element:a(this),animation:{top:E.offset().top-v.top,left:E.offset().left-v.left,opacity:1}})}else{A.push({element:a(this),animation:{top:E.offset().top-v.top,left:E.offset().left-v.left,opacity:1,scale:"1.0"}})}}else{if(!f.useScaling){A.push({element:a(this),animation:{opacity:"0.0"}})}else{A.push({element:a(this),animation:{opacity:"0.0",scale:"0.0"}})}}});l.each(function(F){var E=[];var H=[];if(typeof(f.attribute)=="function"){C=f.attribute(a(this));z.each(function(){if(f.attribute(this)==C){E=a(this);return false}});l.each(function(){if(f.attribute(this)==C){H=a(this);return false}})}else{E=z.filter("["+f.attribute+"="+a(this).attr(f.attribute)+"]");H=l.filter("["+f.attribute+"="+a(this).attr(f.attribute)+"]")}var G;if(E.length===0){if(!f.useScaling){G={opacity:"1.0"}}else{G={opacity:"1.0",scale:"1.0"}}d=H.clone();var D=d.get(0);D.style.position="absolute";D.style.margin="0";D.style.width=w;D.style.top=H.offset().top-v.top+"px";D.style.left=H.offset().left-v.left+"px";d.css("opacity",0);if(f.useScaling){d.css("transform","scale(0.0)")}d.appendTo(B);A.push({element:a(d),animation:G})}});u.remove();f.enhancement(B);for(x=0;x<A.length;x++){A[x].element.animate(A[x].animation,f.duration,f.easing,t)}})}})(jQuery);